wwfregions$chp07 <- 0
wwfregions$chp08 <- 0
wwfregions$chp09 <- 0
wwfregions$chp10 <- 0
wwfregions$chp11 <- 0
wwfregions$chp12 <- 0
View(wwfregions)
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[4,'ECO_ID'], ]
View(selectbioclim)
Biomeclimate[,which(colnames(Biomeclimate)=='t01')]
which(colnames(Biomeclimate)=='t01')
colnames(Biomeclimate)=='t01'
[which(colnames(Biomeclimate)=='t01')]
colnames(Biomeclimate)[which(colnames(Biomeclimate)=='t01')]
colnames(Biomeclimate)[which(colnames(Biomeclimate)=='t01')+1]
model1 = lm(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+1-1] ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
as.numeric(model1$coef[5])
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[29,'ECO_ID'], ]
model1 = lm(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+1-1] ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
as.numeric(model1$coef[5])
colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+1-1]
selectbioclim
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
Biomeclimate[,which(colnames(Biomeclimate)=='t01')]
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'], ]
model1 = lm(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1] ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
wwfregions[j,which(colnames(selectbioclim)=='t01')+j-1] <-
as.numeric(model1$coef[5])
}}
Biomeclimate[,which(colnames(Biomeclimate)=='t01')]
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[1,'ECO_ID'], ]
model1 = lm(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1] ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
wwfregions[1,which(colnames(selectbioclim)=='t01')+5-1] <-
as.numeric(model1$coef[5])
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[1,'ECO_ID'], ]
View(selectbioclim)
model1 = lm(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1] ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
which(colnames(selectbioclim)=='t01')
which(colnames(selectbioclim)=='t01')+5-1
colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]
View(selectbioclim)
head(selectbioclim)
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[1,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
View(N2010)
View(selectbioclim)
colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]
model1 = lm('t05' ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
model1 = lm(t05 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1])
model1 = lm(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]) ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1])
selectbioclim[which(colnames(selectbioclim)=='t01')+5-1]
model1 = lm(selectbioclim[which(colnames(selectbioclim)=='t01')+5-1] ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
model1 = as.formulalm(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]) ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim))
model1 = as.formula(lm(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]) ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim))
model1 = lm(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]) ~
Latitude + Longitude + Elevation + Norm, data=selectbioclim)
colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1])
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1])
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1])
v <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]),"~ Latitude + Longitude + Elevation + Norm, data=selectbioclim" )
v
v <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]),"~ Latitude + Longitude + Elevation + Norm, data=selectbioclim" )
model1 = lm(v)
v <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v, data=selectbioclim)
model1
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
v <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v, data=selectbioclim)
wwfregions[i,which(colnames(selectbioclim)=='cht01')+j-1] <-
as.numeric(model1$coef[5])
#
}}
View(wwfregions)
i
j
which(colnames(selectbioclim)=='cht01')+j-1
wwfregions[i,which(colnames(selectbioclim)=='cht01')+j-1]
colnames(selectbioclim)=='cht01'
View(wwfregions)
which(colnames(selectbioclim)=='cht01')
wwfregions[i,which(colnames(wwfregions)=='cht01')+j-1]
which(colnames(wwfregions)=='cht01')+j-1
wwfregions1 <- aggregate(N1990[,c('ID')], by=list(N1990$ECO_ID,N1990$ECO_NAME), FUN='length')
colnames(wwfregions1) <- c('ECO_ID', 'ECO_NAME', 'N1990')
wwfregions2 <- aggregate(N2010[,c('ID')], by=list(N2010$ECO_ID,N2010$ECO_NAME), FUN='length')
colnames(wwfregions2) <- c('ECO_ID', 'ECO_NAME', 'N2010')
wwfregions<- merge(wwfregions2, wwfregions1[,c('ECO_ID', 'N1990')], by='ECO_ID', all.x = TRUE)
wwfregions$cht01 <- 0
wwfregions$cht02 <- 0
wwfregions$cht03 <- 0
wwfregions$cht04 <- 0
wwfregions$cht05 <- 0
wwfregions$cht06 <- 0
wwfregions$cht07 <- 0
wwfregions$cht08 <- 0
wwfregions$cht09 <- 0
wwfregions$cht10 <- 0
wwfregions$cht11 <- 0
wwfregions$cht12 <- 0
wwfregions$chtl01 <- 0
wwfregions$chtl02 <- 0
wwfregions$chtl03 <- 0
wwfregions$chtl04 <- 0
wwfregions$chtl05 <- 0
wwfregions$chtl06 <- 0
wwfregions$chtl07 <- 0
wwfregions$chtl08 <- 0
wwfregions$chtl09 <- 0
wwfregions$chtl10 <- 0
wwfregions$chtl11 <- 0
wwfregions$chtl12 <- 0
wwfregions$chp01 <- 0
wwfregions$chp02 <- 0
wwfregions$chp03 <- 0
wwfregions$chp04 <- 0
wwfregions$chp05 <- 0
wwfregions$chp06 <- 0
wwfregions$chp07 <- 0
wwfregions$chp08 <- 0
wwfregions$chp09 <- 0
wwfregions$chp10 <- 0
wwfregions$chp11 <- 0
wwfregions$chp12 <- 0
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
v <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='cht01')+j-1] <-
as.numeric(model1$coef[5])
#
}}
v2 <- paste("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),") ~ Latitude + Longitude + Elevation + Norm" )
v2
v2 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),") ~ Latitude + Longitude + Elevation + Norm" )
v2
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
v1 <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v1, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='cht01')+j-1] <-
as.numeric(model1$coef[5])
}
for (j in 1:12){
v2 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='p01')+j-1]),") ~ Latitude + Longitude + Elevation + Norm" )
model2 = lm(v2, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='chp01')+j-1] <-
as.numeric(model1$coef[5])
}
}
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
v1 <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v1, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='cht01')+j-1] <-
as.numeric(model1$coef[5])
}
for (j in 1:12){
v2 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='p01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
model2 = lm(v2, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='chp01')+j-1] <-
as.numeric(model1$coef[5])
}
}
#cluster analysis packages
library(vegan)
library(cluster)
library(ape)
#color pallette
library(RColorBrewer)
library(colorspace)
#classification tree packages
library(rpart)
library(rpart.plot)
# scatter plot matrix packages
library(car)
# Create a scatter plot matrix
library(ggplot2)
#calculate percentiles
library(plyr)
Biomeclimate <- read.delim("data/BiomeClimate3.txt")
DaysMonth <- read.delim("data/DaysMonth.txt")
biomesummary<-read.delim("data/biomesummary.txt")
Norms2010<-read.delim("data/Norms2010.txt")
ecolink <- readRDS('data/ecolink.RDS')
Norms2010$p01 <- Norms2010$pp01*10
Norms2010$p02 <- Norms2010$pp02*10
Norms2010$p03 <- Norms2010$pp03*10
Norms2010$p04 <- Norms2010$pp04*10
Norms2010$p05 <- Norms2010$pp05*10
Norms2010$p06 <- Norms2010$pp06*10
Norms2010$p07 <- Norms2010$pp07*10
Norms2010$p08 <- Norms2010$pp08*10
Norms2010$p09 <- Norms2010$pp09*10
Norms2010$p10 <- Norms2010$pp10*10
Norms2010$p11 <- Norms2010$pp11*10
Norms2010$p12 <- Norms2010$pp12*10
Norms2010 <- merge(ecolink, Norms2010, by='Station_ID')
Norms2010$Norm <- 2010
Norms2010pre <-Norms2010[!is.na(Norms2010$t01)&!is.na(Norms2010$t07)&!is.na(Norms2010$tl01)&!is.na(Norms2010$tl07)&!is.na(Norms2010$p01)&!is.na(Norms2010$p07),c("ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12","p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12","tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12")]
Biomeclimate$Station_ID <- ""
Biomeclimate$Station_Name <- ""
Biomeclimate$State <- ""
Biomeclimate$Norm <- 1990
Biomeclimatepre <-Biomeclimate[!is.na(Biomeclimate$t01)&!is.na(Biomeclimate$t07)&!is.na(Biomeclimate$tl01)&!is.na(Biomeclimate$tl07)&!is.na(Biomeclimate$p01)&!is.na(Biomeclimate$p07),c("ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12","p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12","tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12")]
Biomeclimate <- rbind(Biomeclimatepre,Norms2010pre)
Biomeclimate <- merge(biomesummary, Biomeclimate, by='BIOME')
#generate Uniq ID
Biomeclimate$ID <- seq.int(nrow(Biomeclimate))
rm(ecolink, Norms2010, Norms2010pre, biomesummary, Biomeclimatepre)
Biomeclimate<-Biomeclimate[,c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12","p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12","tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12")]
N1990 <- Biomeclimate[Biomeclimate$Norm == 1990,]
N2010 <- Biomeclimate[Biomeclimate$Norm == 2010,]
wwfregions1 <- aggregate(N1990[,c('ID')], by=list(N1990$ECO_ID,N1990$ECO_NAME), FUN='length')
colnames(wwfregions1) <- c('ECO_ID', 'ECO_NAME', 'N1990')
wwfregions2 <- aggregate(N2010[,c('ID')], by=list(N2010$ECO_ID,N2010$ECO_NAME), FUN='length')
colnames(wwfregions2) <- c('ECO_ID', 'ECO_NAME', 'N2010')
wwfregions<- merge(wwfregions2, wwfregions1[,c('ECO_ID', 'N1990')], by='ECO_ID', all.x = TRUE)
wwfregions$cht01 <- 0
wwfregions$cht02 <- 0
wwfregions$cht03 <- 0
wwfregions$cht04 <- 0
wwfregions$cht05 <- 0
wwfregions$cht06 <- 0
wwfregions$cht07 <- 0
wwfregions$cht08 <- 0
wwfregions$cht09 <- 0
wwfregions$cht10 <- 0
wwfregions$cht11 <- 0
wwfregions$cht12 <- 0
wwfregions$chtl01 <- 0
wwfregions$chtl02 <- 0
wwfregions$chtl03 <- 0
wwfregions$chtl04 <- 0
wwfregions$chtl05 <- 0
wwfregions$chtl06 <- 0
wwfregions$chtl07 <- 0
wwfregions$chtl08 <- 0
wwfregions$chtl09 <- 0
wwfregions$chtl10 <- 0
wwfregions$chtl11 <- 0
wwfregions$chtl12 <- 0
wwfregions$chp01 <- 0
wwfregions$chp02 <- 0
wwfregions$chp03 <- 0
wwfregions$chp04 <- 0
wwfregions$chp05 <- 0
wwfregions$chp06 <- 0
wwfregions$chp07 <- 0
wwfregions$chp08 <- 0
wwfregions$chp09 <- 0
wwfregions$chp10 <- 0
wwfregions$chp11 <- 0
wwfregions$chp12 <- 0
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
v1 <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v1, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='cht01')+j-1] <-
as.numeric(model1$coef[5])
}
for (j in 1:12){
v2 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='p01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
model2 = lm(v2, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='chp01')+j-1] <-
as.numeric(model1$coef[5])
}
}
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='tl01')+j-1])
v3 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]) -
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='tl01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
v3 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1])", - ",
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='tl01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
v3 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1])," - ",
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='tl01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
View(wwfregions)
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
v1 <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v1, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='cht01')+j-1] <-
as.numeric(model1$coef[5])
}
for (j in 1:12){
v2 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='p01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
model2 = lm(v2, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='chp01')+j-1] <-
as.numeric(model1$coef[5])
}
for (j in 1:12){
v3 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1])," - ",
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='tl01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
model2 = lm(v3, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='chtl01')+j-1] <-
as.numeric(model1$coef[5])
}
}
View(wwfregions)
#cluster analysis packages
library(vegan)
library(cluster)
library(ape)
#color pallette
library(RColorBrewer)
library(colorspace)
#classification tree packages
library(rpart)
library(rpart.plot)
# scatter plot matrix packages
library(car)
# Create a scatter plot matrix
library(ggplot2)
#calculate percentiles
library(plyr)
Biomeclimate <- read.delim("data/BiomeClimate3.txt")
DaysMonth <- read.delim("data/DaysMonth.txt")
biomesummary<-read.delim("data/biomesummary.txt")
Norms2010<-read.delim("data/Norms2010.txt")
ecolink <- readRDS('data/ecolink.RDS')
Norms2010$p01 <- Norms2010$pp01*10
Norms2010$p02 <- Norms2010$pp02*10
Norms2010$p03 <- Norms2010$pp03*10
Norms2010$p04 <- Norms2010$pp04*10
Norms2010$p05 <- Norms2010$pp05*10
Norms2010$p06 <- Norms2010$pp06*10
Norms2010$p07 <- Norms2010$pp07*10
Norms2010$p08 <- Norms2010$pp08*10
Norms2010$p09 <- Norms2010$pp09*10
Norms2010$p10 <- Norms2010$pp10*10
Norms2010$p11 <- Norms2010$pp11*10
Norms2010$p12 <- Norms2010$pp12*10
Norms2010 <- merge(ecolink, Norms2010, by='Station_ID')
Norms2010$Norm <- 2010
Norms2010pre <-Norms2010[!is.na(Norms2010$t01)&!is.na(Norms2010$t07)&!is.na(Norms2010$tl01)&!is.na(Norms2010$tl07)&!is.na(Norms2010$p01)&!is.na(Norms2010$p07),c("ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12","p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12","tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12")]
Biomeclimate$Station_ID <- ""
Biomeclimate$Station_Name <- ""
Biomeclimate$State <- ""
Biomeclimate$Norm <- 1990
Biomeclimatepre <-Biomeclimate[!is.na(Biomeclimate$t01)&!is.na(Biomeclimate$t07)&!is.na(Biomeclimate$tl01)&!is.na(Biomeclimate$tl07)&!is.na(Biomeclimate$p01)&!is.na(Biomeclimate$p07),c("ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12","p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12","tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12")]
Biomeclimate <- rbind(Biomeclimatepre,Norms2010pre)
Biomeclimate <- merge(biomesummary, Biomeclimate, by='BIOME')
#generate Uniq ID
Biomeclimate$ID <- seq.int(nrow(Biomeclimate))
rm(ecolink, Norms2010, Norms2010pre, biomesummary, Biomeclimatepre)
Biomeclimate<-Biomeclimate[,c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12","p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12","tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12")]
N1990 <- Biomeclimate[Biomeclimate$Norm == 1990,]
N2010 <- Biomeclimate[Biomeclimate$Norm == 2010,]
wwfregions1 <- aggregate(N1990[,c('ID')], by=list(N1990$ECO_ID,N1990$ECO_NAME), FUN='length')
colnames(wwfregions1) <- c('ECO_ID', 'ECO_NAME', 'N1990')
wwfregions2 <- aggregate(N2010[,c('ID')], by=list(N2010$ECO_ID,N2010$ECO_NAME), FUN='length')
colnames(wwfregions2) <- c('ECO_ID', 'ECO_NAME', 'N2010')
wwfregions<- merge(wwfregions2, wwfregions1[,c('ECO_ID', 'N1990')], by='ECO_ID', all.x = TRUE)
wwfregions$cht01 <- 0
wwfregions$cht02 <- 0
wwfregions$cht03 <- 0
wwfregions$cht04 <- 0
wwfregions$cht05 <- 0
wwfregions$cht06 <- 0
wwfregions$cht07 <- 0
wwfregions$cht08 <- 0
wwfregions$cht09 <- 0
wwfregions$cht10 <- 0
wwfregions$cht11 <- 0
wwfregions$cht12 <- 0
wwfregions$chtl01 <- 0
wwfregions$chtl02 <- 0
wwfregions$chtl03 <- 0
wwfregions$chtl04 <- 0
wwfregions$chtl05 <- 0
wwfregions$chtl06 <- 0
wwfregions$chtl07 <- 0
wwfregions$chtl08 <- 0
wwfregions$chtl09 <- 0
wwfregions$chtl10 <- 0
wwfregions$chtl11 <- 0
wwfregions$chtl12 <- 0
wwfregions$chp01 <- 0
wwfregions$chp02 <- 0
wwfregions$chp03 <- 0
wwfregions$chp04 <- 0
wwfregions$chp05 <- 0
wwfregions$chp06 <- 0
wwfregions$chp07 <- 0
wwfregions$chp08 <- 0
wwfregions$chp09 <- 0
wwfregions$chp10 <- 0
wwfregions$chp11 <- 0
wwfregions$chp12 <- 0
for (i in 1:nrow(wwfregions)){ #create a matrix that shows difference between the 1990 and 2010 normals by ecoregion.
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
selectbioclim$v1 <- 0
for (j in 1:12){
selectbioclim$v1 <- selectbioclim[,which(colnames(selectbioclim)=='t01')+j-1]
model1 = lm(v1 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='cht01')+j-1] <-
as.numeric(model1$coef[5])
}
for (j in 1:12){
selectbioclim$v1 <- log(selectbioclim[,which(colnames(selectbioclim)=='p01')+j-1] +1 )
model1 = lm(v1 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='chp01')+j-1] <-
as.numeric(model1$coef[5])
}
for (j in 1:12){
selectbioclim$v1 <- log(selectbioclim[,which(colnames(selectbioclim)=='t01')+j-1] - selectbioclim[,which(colnames(selectbioclim)=='tl01')+j-1] + 1)
model1 = lm(v1 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='chtl01')+j-1] <-
as.numeric(model1$coef[5])
}
}
bioclimatechange <- merge(Biomeclimate[Biomeclimate$Norm == 2010,], wwfregions, by=c('ECO_ID', 'ECO_NAME'))
bioclimatechange$newt01 <- 0
bioclimatechange$newt02 <- 0
bioclimatechange$newt03 <- 0
bioclimatechange$newt04 <- 0
bioclimatechange$newt05 <- 0
bioclimatechange$newt06 <- 0
bioclimatechange$newt07 <- 0
bioclimatechange$newt08 <- 0
bioclimatechange$newt09 <- 0
bioclimatechange$newt10 <- 0
bioclimatechange$newt11 <- 0
bioclimatechange$newt12 <- 0
bioclimatechange$newtl01 <- 0
bioclimatechange$newtl02 <- 0
bioclimatechange$newtl03 <- 0
bioclimatechange$newtl04 <- 0
bioclimatechange$newtl05 <- 0
bioclimatechange$newtl06 <- 0
bioclimatechange$newtl07 <- 0
bioclimatechange$newtl08 <- 0
bioclimatechange$newtl09 <- 0
bioclimatechange$newtl10 <- 0
bioclimatechange$newtl11 <- 0
bioclimatechange$newtl12 <- 0
bioclimatechange$newp01 <- 0
bioclimatechange$newp02 <- 0
bioclimatechange$newp03 <- 0
bioclimatechange$newp04 <- 0
bioclimatechange$newp05 <- 0
bioclimatechange$newp06 <- 0
bioclimatechange$newp07 <- 0
bioclimatechange$newp08 <- 0
bioclimatechange$newp09 <- 0
bioclimatechange$newp10 <- 0
bioclimatechange$newp11 <- 0
bioclimatechange$newp12 <- 0
for (j in 1:12){
bioclimatechange[,which(colnames(bioclimatechange)=='newt01')+j-1] <- bioclimatechange[,which(colnames(bioclimatechange)=='t01')+j-1] - bioclimatechange[,which(colnames(bioclimatechange)=='cht01')+j-1]*20
bioclimatechange[,which(colnames(bioclimatechange)=='newtl01')+j-1] <- bioclimatechange[,which(colnames(bioclimatechange)=='newt01')+j-1] - pmax(exp(log(bioclimatechange[,which(colnames(bioclimatechange)=='t01')+j-1] - bioclimatechange[,which(colnames(bioclimatechange)=='tl01')+j-1] +1) - bioclimatechange[,which(colnames(bioclimatechange)=='chtl01')+j-1]*20) -1, 0) #predict low, ensure that low is never higher than mean.
bioclimatechange[,which(colnames(bioclimatechange)=='newp01')+j-1] <- pmax(exp(log(bioclimatechange[,which(colnames(bioclimatechange)=='p01')+j-1] + 1) - bioclimatechange[,which(colnames(bioclimatechange)=='chp01')+j-1]*20) - 1, 0) #predict precip, ensure that precip is never negative.
}
USH_station<-read.delim("data/Ushcn-stations.txt")
View(USH_station)
USH_station
USH_station <- USH_station[,c('lat', 'lon', 'elev', 'state', 'station_Name', 'StationID')]
View(USH_station)
USH_station <- merge(USH_station, ecolink, by.x = 'StationID', by.y = 'Station_ID')
ecolink <- readRDS('data/ecolink.RDS')
USH_station <- merge(USH_station, ecolink, by.x = 'StationID', by.y = 'Station_ID')
View(USH_station)
View(USH_station)
View(ecolink)
ecolink
USH_station<-read.delim("data/Ushcn-stations.txt")
ecolink <- readRDS('data/ecolink.RDS')
USH_station <- USH_station[,c('lat', 'lon', 'elev', 'state', 'station_Name', 'StationID')]
USH_station <- merge(USH_station, ecolink, by.x = 'StationID', by.y = 'Station_ID')
USH_stationjoin<-read.csv("data/ushjoin.csv")
View(USH_stationjoin)
USH_stationjoin<-read.csv("data/ushjoin.csv")
View(USH_stationjoin)
Norms2010<-read.delim("data/Norms2010.txt")
USH_station<-read.delim("data/Ushcn-stations.txt")
ecolink <- readRDS('data/ecolink.RDS')
USH_stationjoin<-read.csv("data/ushjoin.csv")
USH_station <- USH_station[,c('lat', 'lon', 'elev', 'state', 'station_Name', 'StationID')]
USH_station <- merge(USH_station, USH_stationjoin, by.x = 'StationID', by.y = 'StationID')
View(USH_station)
