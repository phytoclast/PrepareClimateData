model1 = lm(t07 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
summary(model1)
model1 = lm(t01 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
summary(model1)
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[85,'ECO_ID'], ]
model1 = lm(t01 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
summary(model1)
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[85,'ECO_ID'], ]
model1 = lm(t07 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
summary(model1)
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[26,'ECO_ID'], ]
model1 = lm(t07 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
summary(model1)
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[28,'ECO_ID'], ]
model1 = lm(t07 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
summary(model1)
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[28,'ECO_ID'], ]
model1 = lm(t01 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
summary(model1)
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[28,'ECO_ID'], ]
model1 = lm(tl01 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
summary(model1)
model1$coefficients
model1$coefficients$Norm
model1$coefficients[5]
this <-  model1$coefficients[5]
this <-  number(model1$coefficients[5])
this
this <-  (model1$coef[5])
this
this*20
as.name(model1$coef[5])
as.numeric(model1$coef[5])
this <-  as.numeric(model1$coef[5])
this*20
model1 = lm(t01 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
summary(model1)
this <-  as.numeric(model1$coef[5])
this*20
model1 = lm(t07 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
summary(model1)
this <-  as.numeric(model1$coef[5])
this*20
library(cluster)
library(ape)
#color pallette
library(RColorBrewer)
library(colorspace)
#classification tree packages
library(rpart)
library(rpart.plot)
# scatter plot matrix packages
library(car)
# Create a scatter plot matrix
library(ggplot2)
#calculate percentiles
library(plyr)
Biomeclimate <- read.delim("data/BiomeClimate3.txt")
DaysMonth <- read.delim("data/DaysMonth.txt")
biomesummary<-read.delim("data/biomesummary.txt")
Norms2010<-read.delim("data/Norms2010.txt")
ecolink <- readRDS('data/ecolink.RDS')
Norms2010$p01 <- Norms2010$pp01*10
Norms2010$p02 <- Norms2010$pp02*10
Norms2010$p03 <- Norms2010$pp03*10
Norms2010$p04 <- Norms2010$pp04*10
Norms2010$p05 <- Norms2010$pp05*10
Norms2010$p06 <- Norms2010$pp06*10
Norms2010$p07 <- Norms2010$pp07*10
Norms2010$p08 <- Norms2010$pp08*10
Norms2010$p09 <- Norms2010$pp09*10
Norms2010$p10 <- Norms2010$pp10*10
Norms2010$p11 <- Norms2010$pp11*10
Norms2010$p12 <- Norms2010$pp12*10
Norms2010 <- merge(ecolink, Norms2010, by='Station_ID')
Norms2010$Norm <- 2010
Norms2010pre <-Norms2010[!is.na(Norms2010$t01)&!is.na(Norms2010$t07)&!is.na(Norms2010$tl01)&!is.na(Norms2010$tl07)&!is.na(Norms2010$p01)&!is.na(Norms2010$p07),c("ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12","p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12","tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12")]
Biomeclimate$Station_ID <- ""
Biomeclimate$Station_Name <- ""
Biomeclimate$State <- ""
Biomeclimate$Norm <- 1990
Biomeclimatepre <-Biomeclimate[!is.na(Biomeclimate$t01)&!is.na(Biomeclimate$t07)&!is.na(Biomeclimate$tl01)&!is.na(Biomeclimate$tl07)&!is.na(Biomeclimate$p01)&!is.na(Biomeclimate$p07),c("ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12","p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12","tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12")]
Biomeclimate <- rbind(Biomeclimatepre,Norms2010pre)
Biomeclimate <- merge(biomesummary, Biomeclimate, by='BIOME')
#generate Uniq ID
Biomeclimate$ID <- seq.int(nrow(Biomeclimate))
rm(ecolink, Norms2010, Norms2010pre, biomesummary, Biomeclimatepre)
Biomeclimate<-Biomeclimate[,c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12","p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12","tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12")]
N1990 <- Biomeclimate[Biomeclimate$Norm == 1990,]
N2010 <- Biomeclimate[Biomeclimate$Norm == 2010,]
wwfregions1 <- aggregate(N1990[,c('ID')], by=list(N1990$ECO_ID,N1990$ECO_NAME), FUN='length')
colnames(wwfregions1) <- c('ECO_ID', 'ECO_NAME', 'N1990')
wwfregions2 <- aggregate(N2010[,c('ID')], by=list(N2010$ECO_ID,N2010$ECO_NAME), FUN='length')
colnames(wwfregions2) <- c('ECO_ID', 'ECO_NAME', 'N2010')
wwfregions<- merge(wwfregions2, wwfregions1[,c('ECO_ID', 'N1990')], by='ECO_ID', all.x = TRUE)
Biomeclimate[,which(colnames(Biomeclimate)=='b01')]
which(colnames(Biomeclimate)=='t01')
model1 = lm(log(p07) ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
Biomeclimate[,which(colnames(Biomeclimate)=='t01')]
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[28,'ECO_ID'], ]
model1 = lm(log(p07) ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
model1
model1 = lm((p07) ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
model1
adjClim <- N2010
View(adjClim)
adjClim[1,3] <- 'poop'
View(wwfregions)
adjClim[adjClim$ECO_ID %in% '50401',which(colnames(adjClim)=='t01')] <- 666
View(adjClim)
View(wwfregions)
adjClim <- wwfregions
adjClim$cht01 <- 0
adjClim$cht02 <- 0
adjClim$cht03 <- 0
adjClim$cht04 <- 0
adjClim$cht05 <- 0
adjClim$cht06 <- 0
adjClim$cht07 <- 0
adjClim$cht08 <- 0
adjClim$cht09 <- 0
adjClim$cht10 <- 0
adjClim$cht11 <- 0
adjClim$cht12 <- 0
adjClim$chtl01 <- 0
adjClim$chtl02 <- 0
adjClim$chtl03 <- 0
adjClim$chtl04 <- 0
adjClim$chtl05 <- 0
adjClim$chtl06 <- 0
adjClim$chtl07 <- 0
adjClim$chtl08 <- 0
adjClim$chtl09 <- 0
adjClim$chtl10 <- 0
adjClim$chtl11 <- 0
adjClim$chtl12 <- 0
adjClim$chp01 <- 0
adjClim$chp02 <- 0
adjClim$chp03 <- 0
adjClim$chp04 <- 0
adjClim$chp05 <- 0
adjClim$chp06 <- 0
adjClim$chp07 <- 0
adjClim$chp08 <- 0
adjClim$chp09 <- 0
adjClim$chp10 <- 0
adjClim$chp11 <- 0
adjClim$chp12 <- 0
View(adjClim)
wwfregions1 <- aggregate(N1990[,c('ID')], by=list(N1990$ECO_ID,N1990$ECO_NAME), FUN='length')
colnames(wwfregions1) <- c('ECO_ID', 'ECO_NAME', 'N1990')
wwfregions2 <- aggregate(N2010[,c('ID')], by=list(N2010$ECO_ID,N2010$ECO_NAME), FUN='length')
colnames(wwfregions2) <- c('ECO_ID', 'ECO_NAME', 'N2010')
wwfregions<- merge(wwfregions2, wwfregions1[,c('ECO_ID', 'N1990')], by='ECO_ID', all.x = TRUE)
wwfregions$cht01 <- 0
wwfregions$cht02 <- 0
wwfregions$cht03 <- 0
wwfregions$cht04 <- 0
wwfregions$cht05 <- 0
wwfregions$cht06 <- 0
wwfregions$cht07 <- 0
wwfregions$cht08 <- 0
wwfregions$cht09 <- 0
wwfregions$cht10 <- 0
wwfregions$cht11 <- 0
wwfregions$cht12 <- 0
wwfregions$chtl01 <- 0
wwfregions$chtl02 <- 0
wwfregions$chtl03 <- 0
wwfregions$chtl04 <- 0
wwfregions$chtl05 <- 0
wwfregions$chtl06 <- 0
wwfregions$chtl07 <- 0
wwfregions$chtl08 <- 0
wwfregions$chtl09 <- 0
wwfregions$chtl10 <- 0
wwfregions$chtl11 <- 0
wwfregions$chtl12 <- 0
wwfregions$chp01 <- 0
wwfregions$chp02 <- 0
wwfregions$chp03 <- 0
wwfregions$chp04 <- 0
wwfregions$chp05 <- 0
wwfregions$chp06 <- 0
wwfregions$chp07 <- 0
wwfregions$chp08 <- 0
wwfregions$chp09 <- 0
wwfregions$chp10 <- 0
wwfregions$chp11 <- 0
wwfregions$chp12 <- 0
View(wwfregions)
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[4,'ECO_ID'], ]
View(selectbioclim)
Biomeclimate[,which(colnames(Biomeclimate)=='t01')]
which(colnames(Biomeclimate)=='t01')
colnames(Biomeclimate)=='t01'
[which(colnames(Biomeclimate)=='t01')]
colnames(Biomeclimate)[which(colnames(Biomeclimate)=='t01')]
colnames(Biomeclimate)[which(colnames(Biomeclimate)=='t01')+1]
model1 = lm(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+1-1] ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
as.numeric(model1$coef[5])
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[29,'ECO_ID'], ]
model1 = lm(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+1-1] ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
as.numeric(model1$coef[5])
colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+1-1]
selectbioclim
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
Biomeclimate[,which(colnames(Biomeclimate)=='t01')]
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'], ]
model1 = lm(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1] ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
wwfregions[j,which(colnames(selectbioclim)=='t01')+j-1] <-
as.numeric(model1$coef[5])
}}
Biomeclimate[,which(colnames(Biomeclimate)=='t01')]
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[1,'ECO_ID'], ]
model1 = lm(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1] ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
wwfregions[1,which(colnames(selectbioclim)=='t01')+5-1] <-
as.numeric(model1$coef[5])
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[1,'ECO_ID'], ]
View(selectbioclim)
model1 = lm(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1] ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
which(colnames(selectbioclim)=='t01')
which(colnames(selectbioclim)=='t01')+5-1
colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]
View(selectbioclim)
head(selectbioclim)
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[1,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
View(N2010)
View(selectbioclim)
colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]
model1 = lm('t05' ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
model1 = lm(t05 ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1])
model1 = lm(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]) ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1])
selectbioclim[which(colnames(selectbioclim)=='t01')+5-1]
model1 = lm(selectbioclim[which(colnames(selectbioclim)=='t01')+5-1] ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim)
model1 = as.formulalm(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]) ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim))
model1 = as.formula(lm(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]) ~ Latitude + Longitude + Elevation + Norm, data=selectbioclim))
model1 = lm(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]) ~
Latitude + Longitude + Elevation + Norm, data=selectbioclim)
colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1])
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1])
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1])
v <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]),"~ Latitude + Longitude + Elevation + Norm, data=selectbioclim" )
v
v <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]),"~ Latitude + Longitude + Elevation + Norm, data=selectbioclim" )
model1 = lm(v)
v <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+5-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v, data=selectbioclim)
model1
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
v <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v, data=selectbioclim)
wwfregions[i,which(colnames(selectbioclim)=='cht01')+j-1] <-
as.numeric(model1$coef[5])
#
}}
View(wwfregions)
i
j
which(colnames(selectbioclim)=='cht01')+j-1
wwfregions[i,which(colnames(selectbioclim)=='cht01')+j-1]
colnames(selectbioclim)=='cht01'
View(wwfregions)
which(colnames(selectbioclim)=='cht01')
wwfregions[i,which(colnames(wwfregions)=='cht01')+j-1]
which(colnames(wwfregions)=='cht01')+j-1
wwfregions1 <- aggregate(N1990[,c('ID')], by=list(N1990$ECO_ID,N1990$ECO_NAME), FUN='length')
colnames(wwfregions1) <- c('ECO_ID', 'ECO_NAME', 'N1990')
wwfregions2 <- aggregate(N2010[,c('ID')], by=list(N2010$ECO_ID,N2010$ECO_NAME), FUN='length')
colnames(wwfregions2) <- c('ECO_ID', 'ECO_NAME', 'N2010')
wwfregions<- merge(wwfregions2, wwfregions1[,c('ECO_ID', 'N1990')], by='ECO_ID', all.x = TRUE)
wwfregions$cht01 <- 0
wwfregions$cht02 <- 0
wwfregions$cht03 <- 0
wwfregions$cht04 <- 0
wwfregions$cht05 <- 0
wwfregions$cht06 <- 0
wwfregions$cht07 <- 0
wwfregions$cht08 <- 0
wwfregions$cht09 <- 0
wwfregions$cht10 <- 0
wwfregions$cht11 <- 0
wwfregions$cht12 <- 0
wwfregions$chtl01 <- 0
wwfregions$chtl02 <- 0
wwfregions$chtl03 <- 0
wwfregions$chtl04 <- 0
wwfregions$chtl05 <- 0
wwfregions$chtl06 <- 0
wwfregions$chtl07 <- 0
wwfregions$chtl08 <- 0
wwfregions$chtl09 <- 0
wwfregions$chtl10 <- 0
wwfregions$chtl11 <- 0
wwfregions$chtl12 <- 0
wwfregions$chp01 <- 0
wwfregions$chp02 <- 0
wwfregions$chp03 <- 0
wwfregions$chp04 <- 0
wwfregions$chp05 <- 0
wwfregions$chp06 <- 0
wwfregions$chp07 <- 0
wwfregions$chp08 <- 0
wwfregions$chp09 <- 0
wwfregions$chp10 <- 0
wwfregions$chp11 <- 0
wwfregions$chp12 <- 0
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
v <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='cht01')+j-1] <-
as.numeric(model1$coef[5])
#
}}
v2 <- paste("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),") ~ Latitude + Longitude + Elevation + Norm" )
v2
v2 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),") ~ Latitude + Longitude + Elevation + Norm" )
v2
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
v1 <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v1, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='cht01')+j-1] <-
as.numeric(model1$coef[5])
}
for (j in 1:12){
v2 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='p01')+j-1]),") ~ Latitude + Longitude + Elevation + Norm" )
model2 = lm(v2, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='chp01')+j-1] <-
as.numeric(model1$coef[5])
}
}
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
v1 <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v1, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='cht01')+j-1] <-
as.numeric(model1$coef[5])
}
for (j in 1:12){
v2 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='p01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
model2 = lm(v2, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='chp01')+j-1] <-
as.numeric(model1$coef[5])
}
}
#cluster analysis packages
library(vegan)
library(cluster)
library(ape)
#color pallette
library(RColorBrewer)
library(colorspace)
#classification tree packages
library(rpart)
library(rpart.plot)
# scatter plot matrix packages
library(car)
# Create a scatter plot matrix
library(ggplot2)
#calculate percentiles
library(plyr)
Biomeclimate <- read.delim("data/BiomeClimate3.txt")
DaysMonth <- read.delim("data/DaysMonth.txt")
biomesummary<-read.delim("data/biomesummary.txt")
Norms2010<-read.delim("data/Norms2010.txt")
ecolink <- readRDS('data/ecolink.RDS')
Norms2010$p01 <- Norms2010$pp01*10
Norms2010$p02 <- Norms2010$pp02*10
Norms2010$p03 <- Norms2010$pp03*10
Norms2010$p04 <- Norms2010$pp04*10
Norms2010$p05 <- Norms2010$pp05*10
Norms2010$p06 <- Norms2010$pp06*10
Norms2010$p07 <- Norms2010$pp07*10
Norms2010$p08 <- Norms2010$pp08*10
Norms2010$p09 <- Norms2010$pp09*10
Norms2010$p10 <- Norms2010$pp10*10
Norms2010$p11 <- Norms2010$pp11*10
Norms2010$p12 <- Norms2010$pp12*10
Norms2010 <- merge(ecolink, Norms2010, by='Station_ID')
Norms2010$Norm <- 2010
Norms2010pre <-Norms2010[!is.na(Norms2010$t01)&!is.na(Norms2010$t07)&!is.na(Norms2010$tl01)&!is.na(Norms2010$tl07)&!is.na(Norms2010$p01)&!is.na(Norms2010$p07),c("ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12","p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12","tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12")]
Biomeclimate$Station_ID <- ""
Biomeclimate$Station_Name <- ""
Biomeclimate$State <- ""
Biomeclimate$Norm <- 1990
Biomeclimatepre <-Biomeclimate[!is.na(Biomeclimate$t01)&!is.na(Biomeclimate$t07)&!is.na(Biomeclimate$tl01)&!is.na(Biomeclimate$tl07)&!is.na(Biomeclimate$p01)&!is.na(Biomeclimate$p07),c("ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12","p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12","tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12")]
Biomeclimate <- rbind(Biomeclimatepre,Norms2010pre)
Biomeclimate <- merge(biomesummary, Biomeclimate, by='BIOME')
#generate Uniq ID
Biomeclimate$ID <- seq.int(nrow(Biomeclimate))
rm(ecolink, Norms2010, Norms2010pre, biomesummary, Biomeclimatepre)
Biomeclimate<-Biomeclimate[,c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation","t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12","p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12","tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12")]
N1990 <- Biomeclimate[Biomeclimate$Norm == 1990,]
N2010 <- Biomeclimate[Biomeclimate$Norm == 2010,]
wwfregions1 <- aggregate(N1990[,c('ID')], by=list(N1990$ECO_ID,N1990$ECO_NAME), FUN='length')
colnames(wwfregions1) <- c('ECO_ID', 'ECO_NAME', 'N1990')
wwfregions2 <- aggregate(N2010[,c('ID')], by=list(N2010$ECO_ID,N2010$ECO_NAME), FUN='length')
colnames(wwfregions2) <- c('ECO_ID', 'ECO_NAME', 'N2010')
wwfregions<- merge(wwfregions2, wwfregions1[,c('ECO_ID', 'N1990')], by='ECO_ID', all.x = TRUE)
wwfregions$cht01 <- 0
wwfregions$cht02 <- 0
wwfregions$cht03 <- 0
wwfregions$cht04 <- 0
wwfregions$cht05 <- 0
wwfregions$cht06 <- 0
wwfregions$cht07 <- 0
wwfregions$cht08 <- 0
wwfregions$cht09 <- 0
wwfregions$cht10 <- 0
wwfregions$cht11 <- 0
wwfregions$cht12 <- 0
wwfregions$chtl01 <- 0
wwfregions$chtl02 <- 0
wwfregions$chtl03 <- 0
wwfregions$chtl04 <- 0
wwfregions$chtl05 <- 0
wwfregions$chtl06 <- 0
wwfregions$chtl07 <- 0
wwfregions$chtl08 <- 0
wwfregions$chtl09 <- 0
wwfregions$chtl10 <- 0
wwfregions$chtl11 <- 0
wwfregions$chtl12 <- 0
wwfregions$chp01 <- 0
wwfregions$chp02 <- 0
wwfregions$chp03 <- 0
wwfregions$chp04 <- 0
wwfregions$chp05 <- 0
wwfregions$chp06 <- 0
wwfregions$chp07 <- 0
wwfregions$chp08 <- 0
wwfregions$chp09 <- 0
wwfregions$chp10 <- 0
wwfregions$chp11 <- 0
wwfregions$chp12 <- 0
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
v1 <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v1, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='cht01')+j-1] <-
as.numeric(model1$coef[5])
}
for (j in 1:12){
v2 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='p01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
model2 = lm(v2, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='chp01')+j-1] <-
as.numeric(model1$coef[5])
}
}
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='tl01')+j-1])
v3 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]) -
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='tl01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
v3 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1])", - ",
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='tl01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
v3 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1])," - ",
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='tl01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
View(wwfregions)
for (i in 1:nrow(wwfregions)){
for (j in 1:24){
selectbioclim <- Biomeclimate[Biomeclimate$ECO_ID %in% wwfregions[i,'ECO_ID'],    c("ID","ECO_ID","ECO_NAME","BIOME","Station_ID","Station_Name","State","Norm","Latitude","Longitude","Elevation",
"t01","t02","t03","t04","t05","t06","t07","t08","t09","t10","t11","t12",
"tl01","tl02","tl03","tl04","tl05","tl06","tl07","tl08","tl09","tl10","tl11","tl12",
"p01","p02","p03","p04","p05","p06","p07","p08","p09","p10","p11","p12") ]
v1 <- paste(as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1]),"~ Latitude + Longitude + Elevation + Norm" )
model1 = lm(v1, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='cht01')+j-1] <-
as.numeric(model1$coef[5])
}
for (j in 1:12){
v2 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='p01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
model2 = lm(v2, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='chp01')+j-1] <-
as.numeric(model1$coef[5])
}
for (j in 1:12){
v3 <- paste0("log(", as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='t01')+j-1])," - ",
as.name(colnames(selectbioclim)[which(colnames(selectbioclim)=='tl01')+j-1]),"+1) ~ Latitude + Longitude + Elevation + Norm" )
model2 = lm(v3, data=selectbioclim)
wwfregions[i,which(colnames(wwfregions)=='chtl01')+j-1] <-
as.numeric(model1$coef[5])
}
}
View(wwfregions)
